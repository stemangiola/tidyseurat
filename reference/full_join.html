<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Mutating joins — full_join • tidyseurat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mutating joins — full_join"><meta name="description" content="Mutating joins add columns from y to x, matching observations based on
the keys. There are four mutating joins: the inner join, and the three outer
joins.
Inner join


An inner_join() only keeps observations from x that have a matching key
in y.
The most important property of an inner join is that unmatched rows in either
input are not included in the result. This means that generally inner joins
are not appropriate in most analyses, because it is too easy to lose
observations.



Outer joins


The three outer joins keep observations that appear in at least one of the
data frames:
A left_join() keeps all observations in x.
A right_join() keeps all observations in y.
A full_join() keeps all observations in x and y.



"><meta property="og:description" content="Mutating joins add columns from y to x, matching observations based on
the keys. There are four mutating joins: the inner join, and the three outer
joins.
Inner join


An inner_join() only keeps observations from x that have a matching key
in y.
The most important property of an inner join is that unmatched rows in either
input are not included in the result. This means that generally inner joins
are not appropriate in most analyses, because it is too easy to lose
observations.



Outer joins


The three outer joins keep observations that appear in at least one of the
data frames:
A left_join() keeps all observations in x.
A right_join() keeps all observations in y.
A full_join() keeps all observations in x and y.



"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyseurat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/figures_article.html">Code for producing the figures in the article</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Overview of the tidyseurat package</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stemangiola/tidyseurat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mutating joins</h1>
      <small class="dont-index">Source: <a href="https://github.com/stemangiola/tidyseurat/blob/hotfix-Seurat5-one-cell-bug/R/dplyr_methods.R" class="external-link"><code>R/dplyr_methods.R</code></a></small>
      <div class="d-none name"><code>full_join.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Mutating joins add columns from <code>y</code> to <code>x</code>, matching observations based on
the keys. There are four mutating joins: the inner join, and the three outer
joins.</p><div class="section">
<h3 id="inner-join">Inner join<a class="anchor" aria-label="anchor" href="#inner-join"></a></h3>


<p>An <code><a href="inner_join.html">inner_join()</a></code> only keeps observations from <code>x</code> that have a matching key
in <code>y</code>.</p>
<p>The most important property of an inner join is that unmatched rows in either
input are not included in the result. This means that generally inner joins
are not appropriate in most analyses, because it is too easy to lose
observations.</p>
</div>

<div class="section">
<h3 id="outer-joins">Outer joins<a class="anchor" aria-label="anchor" href="#outer-joins"></a></h3>


<p>The three outer joins keep observations that appear in at least one of the
data frames:</p><ul><li><p>A <code><a href="left_join.html">left_join()</a></code> keeps all observations in <code>x</code>.</p></li>
<li><p>A <code><a href="right_join.html">right_join()</a></code> keeps all observations in <code>y</code>.</p></li>
<li><p>A <code>full_join()</code> keeps all observations in <code>x</code> and <code>y</code>.</p></li>
</ul></div>

    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'Seurat'</span></span>
<span><span class="fu">full_join</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, by <span class="op">=</span> <span class="cn">NULL</span>, copy <span class="op">=</span> <span class="cn">FALSE</span>, suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".x"</span>, <span class="st">".y"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>A pair of data frames, data frame extensions (e.g. a tibble), or
lazy data frames (e.g. from dbplyr or dtplyr). See <em>Methods</em>, below, for
more details.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A join specification created with <code><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by()</a></code>, or a character
vector of variables to join by.</p>
<p>If <code>NULL</code>, the default, <code>*_join()</code> will perform a natural join, using all
variables in common across <code>x</code> and <code>y</code>. A message lists the variables so
that you can check they're correct; suppress the message by supplying <code>by</code>
explicitly.</p>
<p>To join on different variables between <code>x</code> and <code>y</code>, use a <code><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by()</a></code>
specification. For example, <code>join_by(a == b)</code> will match <code>x$a</code> to <code>y$b</code>.</p>
<p>To join by multiple variables, use a <code><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by()</a></code> specification with
multiple expressions. For example, <code>join_by(a == b, c == d)</code> will match
<code>x$a</code> to <code>y$b</code> and <code>x$c</code> to <code>y$d</code>. If the column names are the same between
<code>x</code> and <code>y</code>, you can shorten this by listing only the variable names, like
<code>join_by(a, c)</code>.</p>
<p><code><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by()</a></code> can also be used to perform inequality, rolling, and overlap
joins. See the documentation at <a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">?join_by</a> for details on
these types of joins.</p>
<p>For simple equality joins, you can alternatively specify a character vector
of variable names to join by. For example, <code>by = c("a", "b")</code> joins <code>x$a</code>
to <code>y$a</code> and <code>x$b</code> to <code>y$b</code>. If variable names differ between <code>x</code> and <code>y</code>,
use a named character vector like <code>by = c("x_a" = "y_a", "x_b" = "y_b")</code>.</p>
<p>To perform a cross-join, generating all combinations of <code>x</code> and <code>y</code>, see
<code><a href="https://dplyr.tidyverse.org/reference/cross_join.html" class="external-link">cross_join()</a></code>.</p></dd>


<dt id="arg-copy">copy<a class="anchor" aria-label="anchor" href="#arg-copy"></a></dt>
<dd><p>If <code>x</code> and <code>y</code> are not from the same data source,
and <code>copy</code> is <code>TRUE</code>, then <code>y</code> will be copied into the
same src as <code>x</code>.  This allows you to join tables across srcs, but
it is a potentially expensive operation so you must opt into it.</p></dd>


<dt id="arg-suffix">suffix<a class="anchor" aria-label="anchor" href="#arg-suffix"></a></dt>
<dd><p>If there are non-joined duplicate variables in <code>x</code> and
<code>y</code>, these suffixes will be added to the output to disambiguate them.
Should be a character vector of length 2.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters passed onto methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of the same type as <code>x</code> (including the same groups). The order of
the rows and columns of <code>x</code> is preserved as much as possible. The output has
the following properties:</p><ul><li><p>The rows are affect by the join type.</p><ul><li><p><code><a href="inner_join.html">inner_join()</a></code> returns matched <code>x</code> rows.</p></li>
<li><p><code><a href="left_join.html">left_join()</a></code> returns all <code>x</code> rows.</p></li>
<li><p><code><a href="right_join.html">right_join()</a></code>  returns matched of <code>x</code> rows, followed by unmatched <code>y</code> rows.</p></li>
<li><p><code>full_join()</code>  returns all <code>x</code> rows, followed by unmatched <code>y</code> rows.</p></li>
</ul></li>
<li><p>Output columns include all columns from <code>x</code> and all non-key columns from
<code>y</code>. If <code>keep = TRUE</code>, the key columns from <code>y</code> are included as well.</p></li>
<li><p>If non-key columns in <code>x</code> and <code>y</code> have the same name, <code>suffix</code>es are added
to disambiguate. If <code>keep = TRUE</code> and key columns in <code>x</code> and <code>y</code> have
the same name, <code>suffix</code>es are added to disambiguate these as well.</p></li>
<li><p>If <code>keep = FALSE</code>, output columns included in <code>by</code> are coerced to their
common type between <code>x</code> and <code>y</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="many-to-many-relationships">Many-to-many relationships<a class="anchor" aria-label="anchor" href="#many-to-many-relationships"></a></h2>




<p>By default, dplyr guards against many-to-many relationships in equality joins
by throwing a warning. These occur when both of the following are true:</p><ul><li><p>A row in <code>x</code> matches multiple rows in <code>y</code>.</p></li>
<li><p>A row in <code>y</code> matches multiple rows in <code>x</code>.</p></li>
</ul><p>This is typically surprising, as most joins involve a relationship of
one-to-one, one-to-many, or many-to-one, and is often the result of an
improperly specified join. Many-to-many relationships are particularly
problematic because they can result in a Cartesian explosion of the number of
rows returned from the join.</p>
<p>If a many-to-many relationship is expected, silence this warning by
explicitly setting <code>relationship = "many-to-many"</code>.</p>
<p>In production code, it is best to preemptively set <code>relationship</code> to whatever
relationship you expect to exist between the keys of <code>x</code> and <code>y</code>, as this
forces an error to occur immediately if the data doesn't align with your
expectations.</p>
<p>Inequality joins typically result in many-to-many relationships by nature, so
they don't warn on them by default, but you should still take extra care when
specifying an inequality join, because they also have the capability to
return a large number of rows.</p>
<p>Rolling joins don't warn on many-to-many relationships either, but many
rolling joins follow a many-to-one relationship, so it is often useful to
set <code>relationship = "many-to-one"</code> to enforce this.</p>
<p>Note that in SQL, most database providers won't let you specify a
many-to-many relationship between two tables, instead requiring that you
create a third <em>junction table</em> that results in two one-to-many relationships
instead.</p>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>



<p>These functions are <strong>generic</strong>s, which means that packages can provide
implementations (methods) for other classes. See the documentation of
individual methods for extra arguments and differences in behaviour.</p>
<p>Methods available in currently loaded packages:</p><ul><li><p><code><a href="inner_join.html">inner_join()</a></code>: dplyr (<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">data.frame</a></code>), tidyseurat (<code>Seurat</code>)
.</p></li>
<li><p><code><a href="left_join.html">left_join()</a></code>: dplyr (<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">data.frame</a></code>), tidyseurat (<code>Seurat</code>)
.</p></li>
<li><p><code><a href="right_join.html">right_join()</a></code>: dplyr (<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">data.frame</a></code>), tidyseurat (<code>Seurat</code>)
.</p></li>
<li><p><code>full_join()</code>: dplyr (<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">data.frame</a></code>), tidyseurat (<code>Seurat</code>)
.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other joins:
<code><a href="https://dplyr.tidyverse.org/reference/cross_join.html" class="external-link">cross_join</a>()</code>,
<code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">filter-joins</a></code>,
<code><a href="https://dplyr.tidyverse.org/reference/nest_join.html" class="external-link">nest_join</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pbmc_small</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tt</span> <span class="op">&lt;-</span> <span class="va">pbmc_small</span></span></span>
<span class="r-in"><span><span class="va">tt</span> <span class="op">|&gt;</span> <span class="fu">full_join</span><span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>groups<span class="op">=</span><span class="st">"g1"</span>, other<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(groups)`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tidyseurat says: This operation lead to duplicated cell names. A data frame is returned for independent data analysis.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 212 × 30</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .cell orig.ident nCount_RNA nFeature_RNA RNA_snn_res.0.8 letter.idents groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ATGC… SeuratPro…         70           47 0               A             g2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> CATG… SeuratPro…         85           52 0               A             g1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> CATG… SeuratPro…         85           52 0               A             g1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> CATG… SeuratPro…         85           52 0               A             g1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> CATG… SeuratPro…         85           52 0               A             g1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> GAAC… SeuratPro…         87           50 1               B             g2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> TGAC… SeuratPro…        127           56 0               A             g2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AGTC… SeuratPro…        173           53 0               A             g2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TCTG… SeuratPro…         70           48 0               A             g1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TCTG… SeuratPro…         70           48 0               A             g1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 202 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 23 more variables: RNA_snn_res.1 &lt;fct&gt;, PC_1 &lt;dbl&gt;, PC_2 &lt;dbl&gt;, PC_3 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   PC_4 &lt;dbl&gt;, PC_5 &lt;dbl&gt;, PC_6 &lt;dbl&gt;, PC_7 &lt;dbl&gt;, PC_8 &lt;dbl&gt;, PC_9 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   PC_10 &lt;dbl&gt;, PC_11 &lt;dbl&gt;, PC_12 &lt;dbl&gt;, PC_13 &lt;dbl&gt;, PC_14 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   PC_15 &lt;dbl&gt;, PC_16 &lt;dbl&gt;, PC_17 &lt;dbl&gt;, PC_18 &lt;dbl&gt;, PC_19 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   tSNE_1 &lt;dbl&gt;, tSNE_2 &lt;dbl&gt;, other &lt;int&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefano Mangiola.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

